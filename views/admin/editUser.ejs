<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chỉnh sửa người dùng</title>
  <link rel="stylesheet" href="/style/admin.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    .admin-avatar-img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #e0e7ff;
    }
  </style>
</head>

<body>
  <header class="header">
    <div class="header-container">
      <div class="logo"><span>Admin Beru Bike</span></div>
      <nav class="header-nav">
        <ul>
          <li><a href="/admin">Dashboard</a></li>
          <li><a href="/admin/products">Sản phẩm</a></li>
          <li><a href="/admin/users" class="active">Người dùng</a></li>
          <li><a href="/admin/orders">Đơn hàng</a></li>
          <!-- <li><a href="/admin/reports">Báo cáo</a></li> -->
        </ul>
      </nav>
      <div class="user-profile">
        <% if (user.avatar && user.avatar.trim() !=='' ) { %>
          <img src="<%= user.avatar %>" alt="Admin Avatar" class="admin-avatar-img">
          <% } else { %>
            <div class="avatar-circle">
              <%= user.firstName.charAt(0).toUpperCase() %>
            </div>
            <% } %>

              <div class="user-info-text">
                <span class="u-name">
                  <%= user.firstName %>
                    <%= user.lastName %>
                </span>
                <span class="u-role">Administrator</span>
              </div>
              <a href="/auth/logout" class="logout-btn" title="Đăng xuất"><i class="fas fa-sign-out-alt"></i></a>
      </div>
    </div>
  </header>

  <aside class="sidebar">
    <ul class="sidebar-menu">
      <li><a href="/admin/dashboard" class="active"><i class="fas fa-home"></i> Dashboard</a></li>
      <li><a href="/admin/products"><i class="fas fa-box"></i> Sản phẩm</a></li>
      <li><a href="/admin/orders"><i class="fas fa-shopping-cart"></i> Đơn hàng</a></li>
      <li><a href="/admin/users"><i class="fas fa-users"></i> Khách hàng</a></li>
      <!-- <li><a href="/admin/reports"><i class="fas fa-chart-line"></i> Báo cáo</a></li> -->
      <li style="margin-top: auto;"><a href="/admin/settings"><i class="fas fa-cog"></i> Cài đặt</a></li>
    </ul>
  </aside>

  <main class="main-content">
    <div class="container" style="max-width: 800px; margin: 0 auto;">
      <h1 class="page-title">Chỉnh sửa thông tin: <%= editUser.lastName %>
      </h1>

      <% if(typeof error !=='undefined' && error) { %>
        <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
          <%= error %>
        </div>
        <% } %>

          <form action="/admin/users/edit/<%= editUser._id %>" method="POST"
            style="background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">

            <div style="display: flex; gap: 20px;">
              <div style="flex: 1; margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">Họ</label>
                <input type="text" name="firstName" value="<%= editUser.firstName %>" required
                  style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
              </div>
              <div style="flex: 1; margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">Tên</label>
                <input type="text" name="lastName" value="<%= editUser.lastName %>" required
                  style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <label style="display: block; margin-bottom: 8px; font-weight: 600;">Email</label>
              <input type="email" name="email" value="<%= editUser.email %>" required
                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
            </div>

            <div style="margin-bottom: 20px;">
              <label style="display: block; margin-bottom: 8px; font-weight: 600;">Số điện thoại</label>
              <input type="text" name="phone" value="<%= editUser.phone %>" required
                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
            </div>

            <div style="margin-bottom: 20px;">
              <label style="display: block; margin-bottom: 8px; font-weight: 600;">Mật khẩu mới</label>
              <input type="password" name="password" minlength="6" placeholder="Để trống nếu không muốn đổi mật khẩu"
                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; background-color: #fafafa;">
            </div>

            <div style="display: flex; gap: 20px;">
              <div style="flex: 1; margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">Vai trò</label>
                <select name="role" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                  <option value="user" <%=editUser.role==='user' ? 'selected' : '' %>>Khách hàng (User)</option>
                  <option value="admin" <%=editUser.role==='admin' ? 'selected' : '' %>>Quản trị viên (Admin)</option>
                </select>
              </div>

              <div style="flex: 1; margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600;">Giới tính</label>
                <select name="gender" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                  <option value="male" <%=editUser.gender==='male' ? 'selected' : '' %>>Nam</option>
                  <option value="female" <%=editUser.gender==='female' ? 'selected' : '' %>>Nữ</option>
                  <option value="other" <%=editUser.gender==='other' ? 'selected' : '' %>>Khác</option>
                </select>
              </div>
            </div>

            <div style="margin-top: 30px; display: flex; gap: 10px;">
              <button type="submit"
                style="background: #007bff; color: #fff; border: none; padding: 12px 25px; border-radius: 4px; cursor: pointer; font-weight: bold;">
                <i class="fas fa-check"></i> Cập nhật
              </button>
              <a href="/admin/users"
                style="background: #6c757d; color: #fff; text-decoration: none; padding: 12px 25px; border-radius: 4px; font-weight: bold; display: inline-block;">
                Hủy bỏ
              </a>
            </div>

          </form>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 Admin Panel.</p>
    </div>
  </footer>
</body>

</html>